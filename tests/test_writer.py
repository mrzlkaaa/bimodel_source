from . import *
from core.writer import PlainPhitsSourceWriter, StructuredSourceWriter, SourceWriter
from core import config

#* coefs after preprocessing and fitting merged_for_angular.xlsx file
#* A, sigma, weight, E 
coefs = [
    [0.15602598229085982, 41.294418359597906, 0.1806198735111303, '1.000'],
    [0.17516736313710798, 35.03316039000351, 0.15842652053488587, '2.000'],
    [0.20679802330062244, 28.376111763116494, 0.12643587502281745, '3.000'],
    [0.2425735309288575, 23.439742010558426, 0.11288699668233143, '4.000'],
    [0.27875518659372156, 19.930597231813778, 0.09499968465754301, '5.000'],
    [0.29441647295947654, 18.885193953666633, 0.07503194198893058, '6.000'],
    [0.30925027001219263, 17.879769448279067, 0.0596487608534285, '7.000'],
    [0.3097456901487381, 17.796118381633057, 0.04739468188898477, '8.000'],
    [0.29317402023259975, 18.86555298733712, 0.03924422395576887, '9.000'],
    [0.28320357092576265, 19.92314961302598, 0.03426390476106949, '10.000'],
    [0.29050628516499855, 19.639794678401824, 0.0291035228521348, '11.000'],
    [0.2786366861418606, 20.57854622154281, 0.019809183179435013, '12.000'],
    [0.22947656974433506, 25.926197860095648, 0.012268108848568743, '13.000'],
    [0.21099139822827587, 29.107791210369342, 0.009866721262971138, '14.000']
]

coefs_no_sr = [
    [0.0552610735174822, 0.7308398341961057, 0.22685339167007876, '1.000'],
    [0.05994183699668886, 0.6507529572377191, 0.18514814480347913, '2.000'],
    [0.07556530251953836, 0.4841578983830196, 0.13104432084172576, '3.000'],
    [0.10256555096163994, 0.3229770863106447, 0.10615110122798435, '4.000'],
    [0.1305303450396738, 0.2409820800827587, 0.08157241643056845, '5.000'],
    [0.15427544735725518, 0.20300701933924944, 0.06180089922709997, '6.000'],
    [0.16457042319102103, 0.18777978587088343, 0.04717737804305674, '7.000'],
    [0.16834568236199274, 0.1808390398444339, 0.03780313154813841, '8.000'],
    [0.14167038422042186, 0.21986739733235316, 0.032293437522022676, '9.000'],
    [0.1481262089843831, 0.2164260345381233, 0.02812261199975313, '10.000'],
    [0.16040374674426627, 0.20607713980384657, 0.023538588177559074, '11.000'],
    [0.15810192401412357, 0.2047776131005019, 0.016644581122357352, '12.000'],
    [0.13332054267326793, 0.23940363992006336, 0.011853290639356253, '13.000'],
    [0.13604664880059777, 0.25137347139212507, 0.009996706746820029, '14.000']
]

coefs_no_sr_laplace = [
    [0.07160472001113281, 0.5908655908714092, 0.22685339167007876, '1.000'],
    [0.08185262229387856, 0.481755400050664, 0.18514814480347913, '2.000'],
    [0.10746046414323424, 0.339987311628061, 0.13104432084172576, '3.000'],
    [0.14353433009847957, 0.2409730003892038, 0.10615110122798435, '4.000'],
    [0.18113338994806974, 0.18545878807202107, 0.08157241643056845, '5.000'],
    [0.2174494051979963, 0.15373520741357108, 0.06180089922709997, '6.000'],
    [0.2329977781361213, 0.14186726404760383, 0.04717737804305674, '7.000'],
    [0.23743310168678208, 0.13744618853907575, 0.03780313154813841, '8.000'],
    [0.19653281323742744, 0.169092575714328, 0.032293437522022676, '9.000'],
    [0.20597523857229652, 0.16457065291516987, 0.02812261199975313, '10.000'],
    [0.22808658573302326, 0.15119658969748448, 0.023538588177559074, '11.000'],
    [0.2210260355820599, 0.15358011646351366, 0.016644581122357352, '12.000'],
    [0.17195681902660684, 0.19885432487638602, 0.011853290639356253, '13.000'],
    [0.17322643998411905, 0.2083000967360878, 0.009996706746820029, '14.000']
]

coefs_no_sr_laplace_on_half = [
    [0.06851475809474541, 0.5667380417220541, 0.22685339167007876, '1.000'],
    [0.07754189795260498, 0.4620827688690727, 0.18514814480347913, '2.000'],
    [0.09953010052305639, 0.326104796799368, 0.13104432084172576, '3.000'],
    [0.12881847547302133, 0.2311369158561471, 0.10615110122798435, '4.000'],
    [0.15738512565615667, 0.17788577880746217, 0.08157241643056845, '5.000'],
    [0.1835417645411752, 0.14745358432619782, 0.06180089922709997, '6.000'],
    [0.1938968391897306, 0.1360695502452853, 0.04717737804305674, '7.000'],
    [0.1964252277326605, 0.1318270816166687, 0.03780313154813841, '8.000'],
    [0.16845648408731742, 0.16219164812084536, 0.032293437522022676, '9.000'],
    [0.1758062114685443, 0.15785005718970338, 0.02812261199975313, '10.000'],
    [0.19197114674616111, 0.14502150884784637, 0.023538588177559074, '11.000'],
    [0.18652648784754555, 0.14730837074622177, 0.016644581122357352, '12.000'],
    [0.15083298555041025, 0.1907341603150309, 0.011853290639356253, '13.000'],
    [0.15285266873349465, 0.19979366733542453, 0.009996706746820029, '14.000']
]

coefs_no_sr_laplace_28en = [
    [0.07113158857761183, 0.5980997531991394, 0.11842941677642413, '0.750'],
    [0.07230953136506085, 0.5811174407749086, 0.10796624791215219, '1.250'],
    [0.07771069373754871, 0.5198332497349145, 0.09949835666574587, '1.750'],
    [0.08854265958242394, 0.43267618264487673, 0.08550060514115312, '2.250'],
    [0.10083463636998864, 0.3674194569791743, 0.0694757303888039, '2.750'],
    [0.11556187279663406, 0.31101579821528985, 0.06204481345987101, '3.250'],
    [0.12883110385693872, 0.2737298158324555, 0.055499474395092355, '3.750'],
    [0.1567585363290135, 0.2185173743933298, 0.050338364587199896, '4.250'],
    [0.1764905304320394, 0.19051558794265316, 0.04354350195659641, '4.750'],
    [0.19065772164076553, 0.1757036842057011, 0.03790190132468022, '5.250'],
    [0.2031338495377506, 0.16553269394836176, 0.03281390635716114, '5.750'],
    [0.22182785906168828, 0.1511055340235024, 0.028639982310383862, '6.250'],
    [0.23056751652912486, 0.14458537623236434, 0.025144485651601267, '6.750'],
    [0.2369163225973037, 0.14055740455182028, 0.022229598519537295, '7.250'],
    [0.24240177697984347, 0.13535045412632524, 0.019938311783183657, '7.750'],
    [0.2302383510749684, 0.1412628720537227, 0.018055684606003396, '8.250'],
    [0.21254805474307792, 0.15307219331489325, 0.016756489500308898, '8.750'],
    [0.19847364286649838, 0.16866496234594058, 0.0158717117435612, '9.250'],
    [0.2006461956555915, 0.16841832765877257, 0.014852479572179996, '9.750'],
    [0.20588681132382103, 0.16558491573765616, 0.013729798625224445, '10.250'],
    [0.22240274055482342, 0.15429789678946135, 0.01257964549524359, '10.750'],
    [0.23871669478931962, 0.14383617903358056, 0.010969462105030713, '11.250'],
    [0.2377113322310788, 0.14219229268824016, 0.009140186470620296, '11.750'],
    [0.1970710305168764, 0.1725436411486916, 0.007461794368345333, '12.250'],
    [0.19545903083331198, 0.17280212479790918, 0.006349348285994692, '12.750'],
    [0.1492115880967297, 0.23675935845206061, 0.005397822208724176, '13.250'],
    [0.1635831833398183, 0.21837022522816057, 0.00513147891054926, '13.750'],
    [0.18171687236683115, 0.20090953151965787, 0.004739400878627664, '14.250']
]

coefs_deg_sr_laplace = [
    [0.18732331024941057, 56.71832315976201, 0.22144853841418724, '1.000'],
    [0.218197954478218, 43.90694455980234,0.18165904736794017, '2.000'],
    [0.26506959859027973, 33.37702363010718, 0.13135597482533334, '3.000'],
    [0.31330913960265677, 27.148919630381638, 0.10681515579694455, '4.000'],
    [0.3612799981539699, 23.011724180521604, 0.08301796789966095, '5.000'],
    [0.3822232200770715, 21.705635132019896, 0.06298513289350473, '6.000'],
    [0.4028131525890519, 20.47036678125549, 0.04866532237911746, '7.000'],
    [0.4015796190616499, 20.517456502020483, 0.03888709671113342, '8.000'],
    [0.3809157423196334, 21.689131960501403, 0.0333087096306458, '9.000'],
    [0.36802278696227053, 22.744775160163645, 0.02917127291670215, '10.000'],
    [0.3758638472548543, 22.43147374567993, 0.024094603648414394, '11.000'],
    [0.3570965202366533, 23.781986189936227, 0.016901765201204007, '12.000'],
    [0.27724956410299423, 32.61517344210716,0.011776716667167609, '13.000'],
    [0.2392943516763066, 40.36791612503884, 0.009912695648044298, '14.000']
]

coefs_deg_sr_sr_laplace = [
    ['0.5655375963602719', '13.374954022023356',
        '0.22144853841418724', '1.000'],
       ['0.6333317855634262', '12.02528495837048', '0.18165904736794017',
        '2.000'],
       ['0.7249110273387208', '10.62318887067337', '0.13135597482533334',
        '3.000'],
       ['0.801789579743409', '9.744726469412033', '0.10681515579694455',
        '4.000'],
       ['0.8772806501756409', '9.019149425498666', '0.08301796789966095',
        '5.000'],
       ['0.9002586424642393', '8.848007009267809', '0.06298513289350473',
        '6.000'],
       ['0.9352220327022814', '8.548911155834821', '0.04866532237911746',
        '7.000'],
       ['0.9241856047488614', '8.670823338398552', '0.03888709671113342',
        '8.000'],
       ['0.9088529323956186', '8.740904531953001', '0.0333087096306458',
        '9.000'],
       ['0.8777997185370097', '9.033492101680324', '0.02917127291670215',
        '10.000'],
       ['0.8602666721177534', '9.29916337742297', '0.024094603648414394',
        '11.000'],
       ['0.8165326736999696', '9.798592699263402',
        '0.016901765201204007', '12.000'],
       ['0.5968315209199448', '13.685447191827327',
        '0.011776716667167609', '13.000'],
       ['0.43554134707101677', '19.82948932210334',
        '0.009912695648044298', '14.000']
]

coefs_deg_sr_laplace_28en = [
    [0.06105935299430973, 59.11947083211101, 0.11811259339508805, '0.750'],
    [0.06366901516760098, 54.667806463925665, 0.10747994707989364, '1.250'],
    [0.06939107363706228, 47.1972849390789, 0.09888223678302847, '1.750'],
    [0.07675779981870684, 40.46336549433755, 0.0851348035876572, '2.250'],
    [0.08468358268073736, 35.23371324488647, 0.06959550615942742, '2.750'],
    [0.09338161010238262, 30.994571581711913, 0.062243164267092664, '3.250'],
    [0.09981135991095605, 28.551324159839524, 0.05567519460570463, '3.750'],
    [0.1114259743807891, 25.057713550201946, 0.05051504550461388, '4.250'],
    [0.11885960266221338, 23.251625096211374, 0.043698352078322594, '4.750'],
    [0.12362364340026334, 22.252313882970878, 0.038093990690292595, '5.250'],
    [0.12693844948754995, 21.639613478168535, 0.03297577241426935, '5.750'],
    [0.13151155730673297, 20.840388388787666, 0.02878981584989569, '6.250'],
    [0.13569070094760566, 20.08377014054369, 0.025252734582144228, '6.750'],
    [0.1367611171244554, 19.9251024136003, 0.022305653352289966, '7.250'],
    [0.13561875028984177, 20.1549721407347, 0.01994917548775456, '7.750'],
    [0.13397466880227785, 20.342930031035724, 0.018076141910351357, '8.250'],
    [0.13143110742009334, 20.69969373157351, 0.01676326516651576, '8.750'],
    [0.1254681705203358, 21.899000183990125, 0.01594586471501908, '9.250'],
    [0.12742226734476397, 21.506218110144005, 0.014897938303973011, '9.750'],
    [0.12644948044544757, 21.80524887048354, 0.01377125933857272, '10.250'],
    [0.12582821249137463, 22.146535175829662, 0.012600969754202919, '10.750'],
    [0.1319610075482137, 20.954174915322675, 0.010994606479321418, '11.250'],
    [0.13059904501488112, 21.19303540157883, 0.009150578510043689, '11.750'],
    [0.11387739021230031, 24.856630984573844, 0.007464781611498479, '12.250'],
    [0.11312427834000112, 25.030907784497273, 0.006355104982949106, '12.750'],
    [0.07347416582369398, 45.139080142039944, 0.005371976366026984, '13.250'],
    [0.0753417751009892, 43.74152405945251, 0.005128625113715154, '13.750'],
    [0.07853206700398073, 41.44927566105581, 0.004774901910335476, '14.250']
]

groups = [
    0.5, 1.5,  2.5,  3.5,  4.5, 
    5.5,  6.5,  7.5,  8.5,  9.5,  
    10.5,  11.5,  12.5,  13.5,  14.5
]

groups_28en = [
    0.5, 1.0, 1.5, 2.0, 2.5,
    3.0, 3.5, 4.0, 4.5, 5.0,
    5.5, 6.0, 6.5, 7.0, 7.5,
    8.0, 8.5, 9.0, 9.5, 10.0,
    10.5, 11.0, 11.5, 12.0, 12.5,
    13.0, 13.5, 14.0, 14.5
]
@pytest.fixture
def sw():
    return PlainPhitsSourceWriter(
        coefs_deg_sr_laplace_28en, 
        groups_28en, 
        config(),
        source_template="poly_laplace")

def test_params_payload(sw):
    sw.default_source_params
    assert 0

def test_template_path():
    SourceWriter(config=config(), source_template="poly_laplace")
    assert 0

def test_source_params_refactorer(sw):
    print(sw.source_params)
    assert 0

def test_sw_fit_to_template(sw):
    sw.fit_to_template()
    assert 0

def test_sw_make_json(sw):
    sw.config = config()
    sw.make_json()
    assert 0

def test_plsw():
    StructuredSourceWriter(coefs_deg_sr_laplace_28en, groups_28en, source_template="pceld")
    assert 0

@pytest.fixture
def plsw():
    return StructuredSourceWriter(
        coefs_deg_sr_laplace, 
        groups, 
        source_template="pceld")

def test_plsw_fit_to_template(plsw):
    plsw.fit_to_template()
    assert 0

